<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨ºæ–­çµæœ | ç†æƒ³ã®å®¶ã¥ãã‚Šè¨ºæ–­</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">IDEAL HOME</div>
            <nav class="nav">
                <a href="index.html">ãƒ›ãƒ¼ãƒ </a>
                <a href="diagnosis.html">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</a>
            </nav>
        </header>

        <section class="result-section">
            <div class="result-container">
                <h1 class="result-title">ã‚ãªãŸã®ç†æƒ³ã®å®¶</h1>
                <p class="result-subtitle">è¨ºæ–­çµæœã‚’ã‚‚ã¨ã«ã€AIãŒã‚ãªãŸã«ã´ã£ãŸã‚Šã®å®¶ã‚’ã”ææ¡ˆã—ã¾ã™</p>

                <div class="ai-image-section">
                    <h2 class="section-heading">å¤–è¦³ã‚¤ãƒ¡ãƒ¼ã‚¸</h2>
                    <div class="image-placeholder">
                        <div class="placeholder-content">
                            <p>ğŸ </p>
                            <p>AIç”»åƒç”Ÿæˆæº–å‚™ä¸­...</p>
                        </div>
                    </div>
                </div>

                <div class="ai-image-section">
                    <h2 class="section-heading">é–“å–ã‚Šã‚¤ãƒ¡ãƒ¼ã‚¸</h2>
                    <div class="image-placeholder">
                        <div class="placeholder-content">
                            <p>ğŸ“</p>
                            <p>AIç”»åƒç”Ÿæˆæº–å‚™ä¸­...</p>
                        </div>
                    </div>
                </div>

                <div class="result-text-section">
                    <h2 class="section-heading">ã‚ãªãŸã«ãŠã™ã™ã‚ã®å®¶ã¥ãã‚Š</h2>
                    <div class="result-card">
                        <h3>ğŸ“‹ è¨ºæ–­çµæœã‚µãƒãƒªãƒ¼</h3>
                        <div id="summaryText"></div>
                    </div>

                    <div class="result-card">
                        <h3>ğŸ¡ ãŠã™ã™ã‚ã®é–“å–ã‚Šã¨ç‰¹å¾´</h3>
                        <div id="layoutText"></div>
                    </div>

                    <div class="result-card">
                        <h3>ğŸ’° äºˆç®—ã¨åªæ•°ã®ç›®å®‰</h3>
                        <div id="budgetText"></div>
                    </div>
                </div>

                <div class="housemaker-section">
                    <h2 class="section-heading">ãŠã™ã™ã‚ã®ãƒã‚¦ã‚¹ãƒ¡ãƒ¼ã‚«ãƒ¼</h2>
                    <div id="housemakerList"></div>
                </div>

                <div class="action-buttons">
                    <a href="diagnosis.html" class="btn-secondary-large">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</a>
                    <button class="btn-primary-large" onclick="alert('è³‡æ–™è«‹æ±‚æ©Ÿèƒ½ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™')">è³‡æ–™è«‹æ±‚ã™ã‚‹</button>
                </div>
            </div>
        </section>

        <footer class="footer">
            <p>&copy; 2026 IDEAL HOME. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // ã™ã¹ã¦ã®JavaScriptã‚’HTMLã«ç›´æ¥åŸ‹ã‚è¾¼ã¿
        document.addEventListener('DOMContentLoaded', function() {
            const answers = JSON.parse(localStorage.getItem('diagnosisAnswers'));
            
            if (!answers) {
                alert('è¨ºæ–­çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšè¨ºæ–­ã‚’å—ã‘ã¦ãã ã•ã„ã€‚');
                window.location.href = 'diagnosis.html';
                return;
            }
            
            console.log('è¨ºæ–­çµæœ:', answers);
            generateResult(answers);
            generateAIImages(answers);
        });

        function generateResult(answers) {
            generateSummary(answers[1], answers[2], answers[3], answers[4]);
            generateLayout(answers[2], answers[5], answers[6], answers[8]);
            generateBudget(answers[3], answers[2], answers[1]);
            generateHousemakers(answers[4], answers[3], answers[5]);
        }

        async function generateAIImages(answers) {
            console.log('ç”»åƒç”Ÿæˆé–‹å§‹');
            const exteriorPrompt = createExteriorPrompt(answers[4], answers[1]);
            const floorPlanPrompt = createFloorPlanPrompt(answers[2], answers[1]);
            
            await generateImage(exteriorPrompt, 'exterior');
            setTimeout(() => generateImage(floorPlanPrompt, 'floorplan'), 2000);
        }

        function createExteriorPrompt(style, familyType) {
            const styleMapping = {
                'ãƒ¢ãƒ€ãƒ³': 'modern minimalist',
                'å’Œãƒ¢ãƒ€ãƒ³': 'modern Japanese style',
                'åŒ—æ¬§é¢¨': 'Scandinavian Nordic style',
                'å—æ¬§é¢¨': 'Mediterranean style',
                'ã‚·ãƒ³ãƒ—ãƒ«': 'simple clean',
                'ãƒŠãƒãƒ¥ãƒ©ãƒ«': 'natural warm'
            };
            const styleText = styleMapping[style] || 'modern';
            return `beautiful ${styleText} house exterior, professional architecture photo`;
        }

        function createFloorPlanPrompt(rooms) {
            return `${rooms} house floor plan, architectural blueprint, clean professional`;
        }

        async function generateImage(prompt, type) {
            console.log(`${type}ã®ç”»åƒç”Ÿæˆä¸­:`, prompt);
            
            const placeholderElement = document.querySelector(
                type === 'exterior' 
                    ? '.ai-image-section:nth-of-type(1) .image-placeholder'
                    : '.ai-image-section:nth-of-type(2) .image-placeholder'
            );
            
            placeholderElement.innerHTML = `
                <div class="placeholder-content">
                    <div class="loader"></div>
                    <p>AIç”»åƒç”Ÿæˆä¸­...</p>
                </div>
            `;
            
            try {
                const imageUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=1024&height=1024&nologo=true`;
                console.log('ç”»åƒURL:', imageUrl);
                
                const img = new Image();
                img.onload = () => {
                    console.log(`${type}ç”»åƒèª­ã¿è¾¼ã¿æˆåŠŸ`);
                    placeholderElement.innerHTML = `<img src="${imageUrl}" alt="AIç”Ÿæˆç”»åƒ" style="width: 100%; height: auto; border-radius: 15px;">`;
                };
                img.onerror = (e) => {
                    console.error(`${type}ç”»åƒèª­ã¿è¾¼ã¿å¤±æ•—:`, e);
                    placeholderElement.innerHTML = `
                        <div class="placeholder-content">
                            <p>âŒ</p>
                            <p>ç”»åƒç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ</p>
                            <button onclick="location.reload()" style="margin-top: 15px; padding: 10px 20px; background: var(--accent-color); border: none; border-radius: 5px; cursor: pointer;">å†è©¦è¡Œ</button>
                        </div>
                    `;
                };
                img.src = imageUrl;
            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        function generateSummary(family, rooms, budget, style) {
            document.getElementById('summaryText').innerHTML = `
                <p><strong>å®¶æ—æ§‹æˆï¼š</strong>${family}</p>
                <p><strong>å¸Œæœ›é–“å–ã‚Šï¼š</strong>${rooms}</p>
                <p><strong>äºˆç®—æ„Ÿï¼š</strong>${budget}</p>
                <p><strong>å¤–è¦³ã‚¹ã‚¿ã‚¤ãƒ«ï¼š</strong>${style}</p>
            `;
        }

        function generateLayout(rooms, priorities, facilities, lifestyle) {
            document.getElementById('layoutText').innerHTML = `<p>${rooms}ã«é©ã—ãŸé–“å–ã‚Šã‚’ã”ææ¡ˆã—ã¾ã™ã€‚</p>`;
        }

        function generateBudget(budget, rooms) {
            document.getElementById('budgetText').innerHTML = `<p><strong>ã”äºˆç®—ï¼š</strong>${budget}</p>`;
        }

        function generateHousemakers(style, budget) {
            document.getElementById('housemakerList').innerHTML = `
                <div class="housemaker-card">
                    <h4>ãŠã™ã™ã‚ãƒã‚¦ã‚¹ãƒ¡ãƒ¼ã‚«ãƒ¼</h4>
                    <p>è¨ºæ–­çµæœã«åŸºã¥ã„ãŸãƒã‚¦ã‚¹ãƒ¡ãƒ¼ã‚«ãƒ¼ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚</p>
                </div>
            `;
        }
    </script>
</body>
</html>
